spring:
  config:
    activate:
      on-profile: circuitbreaker
server:
  port: 8080
  address: 0.0.0.0

resilience4j:
  circuitbreaker:
    instances:
      backendA:
        registerHealthIndicator: true
        slidingWindowSize: 100
        minimumNumberOfCalls: 10
        failureRateThreshold: 50
        waitDurationInOpenState: 10s
        permittedNumberOfCallsInHalfOpenState: 5
        slidingWindowType: COUNT_BASED
        automaticTransitionFromOpenToHalfOpenEnabled: true 
      backendB:
        registerHealthIndicator: true
        slidingWindowSize: 100
        minimumNumberOfCalls: 10
        failureRateThreshold: 50
        waitDurationInOpenState: 10s
        permittedNumberOfCallsInHalfOpenState: 5
        slidingWindowType: COUNT_BASED


management:
  endpoints:
    web:  
      exposure:
        include: health,prometheus
  endpoint:
    prometheus:
      enabled: true
  metrics:
    export:
      prometheus:
        enabled: true

backend:
  a:
    url: http://localhost:8081/data
    unstableUrl: http://backend-a-1:8080/unstable
  b:
    url: http://localhost:8082/data

logging:
  level:
    io.github.resilience4j.circuitbreaker: DEBUG